<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Telegram Premium Shop</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #1e3c72, #2a5298); color: #fff; min-height: 100vh; }
        .container { max-width: 1200px; margin: 20px auto; padding: 20px; }
        .section { background: rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 30px; }
        .order-card { background: rgba(255, 255, 255, 0.15); padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        .order-card button { padding: 10px 20px; margin: 5px; background: #00aaff; border: none; border-radius: 10px; color: #fff; cursor: pointer; }
        .order-card button:hover { background: #0077cc; }
    </style>
</head>
<body>
    <div class="container">
        <div class="section">
            <h2>Admin Dashboard</h2>
            <button onclick="window.location.href='index.html'">ဆိုင်သို့ပြန်သွားရန်</button>
            <button id="logoutBtn">အကောင့်ထွက်ရန်</button>
            <div id="orders"></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js"></script>
    <script>
const firebaseConfig = {
  apiKey: "AIzaSyBJacTY2m9yQSDPpq7SLzUYZY6fY8qpSBQ",
  authDomain: "telegram-premium-shop.firebaseapp.com",
  projectId: "telegram-premium-shop",
  storageBucket: "telegram-premium-shop.firebasestorage.app",
  messagingSenderId: "180831107855",
  appId: "1:180831107855:web:e8f20d197611ba7026dc7a",
  measurementId: "G-8ETNRSFGP0",
  databaseURL: "https://telegram-premium-shop-default-rtdb.asia-southeast1.firebasedatabase.app/"
};

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();

        auth.onAuthStateChanged(user => {
            if (user && user.email === 'admin@telegrampremiumshop.com') {
                loadOrders();
            } else {
                alert('အက်မင်သာဝင်ခွင့်ရှိသည်။');
                window.location.href = 'index.html';
            }
        });

        document.getElementById('logoutBtn').addEventListener('click', () => {
            auth.signOut().then(() => {
                window.location.href = 'index.html';
            });
        });

        function loadOrders() {
            db.ref('orders').orderByChild('timestamp').on('value', snapshot => {
                const ordersDiv = document.getElementById('orders');
                let ordersHTML = '';
                snapshot.forEach(child => {
                    const order = child.val();
                    ordersHTML += `
                        <div class="order-card">
                            <p><strong>အသုံးပြုသူ ID:</strong> ${order.userId}</p>
                            <p><strong>လအရေအတွက်:</strong> ${order.months}</p>
                            <p><strong>အရေအတွက်:</strong> ${order.quantity}</p>
                            <p><strong>စုစုပေါင်း:</strong> ${order.total} MMK</p>
                            <p><strong>ငွေလွှဲပြီးစီ နောက်ဆုံး ၆ လုံး:</strong> ${order.transactionLast6}</p>
                            <p><strong>Telegram:</strong> ${order.telegramUsername}</p>
                            <p><strong>ငွေပေးချေမှု:</strong> ${order.paymentMethod}</p>
                            <p><strong>အခြေအနေ:</strong> ${order.status}</p>
                            <p><strong>အချိန်:</strong> ${order.timestamp ? new Date(order.timestamp).toLocaleString() : 'စောင့်ဆိုင်းနေ'}</p>
                            ${order.status === 'စောင့်ဆိုင်းနေ' ? `
                                <button onclick="updateOrderStatus('${child.key}', 'အတည်ပြု')">လက်ခံမည်</button>
                                <button onclick="updateOrderStatus('${child.key}', 'ငြင်းဆို')">ငြင်းဆိုမည်</button>
                            ` : ''}
                        </div>
                    `;
                });
                ordersDiv.innerHTML = ordersHTML;
            });
        }

        function updateOrderStatus(orderId, status) {
            db.ref('orders/' + orderId).update({ status }).then(() => {
                db.ref('orders/' + orderId).remove();
                alert(`အော်ဒါကို ${status} ပြီးပါပြီ။`);
            });
        }
    </script>
</body>
</html>
